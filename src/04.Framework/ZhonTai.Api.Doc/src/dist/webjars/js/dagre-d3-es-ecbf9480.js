import"./d3-transition-dcb2c4ce.js";import"./d3-zoom-a2c53521.js";import{h as p,g as D,j as re,k as M,l as k,m as f,n as w,q as rt,v as L,r as Y,s as ye,t as W,w as b,x as T,y as X,z as xe,A as G,B as S,C as he,D as nt,f as ce,E as it,F as H,p as V,G as U,c as at,H as ne,I as $,J as ot,K as st,L as P,b as dt,M as ut}from"./lodash-es-027f92d5.js";import{d as x}from"./d3-selection-de98f9a2.js";import{l as ft,c as ht}from"./d3-shape-8fda5547.js";import{s as ct}from"./d3-fetch-5dc2c9dc.js";var lt="\0",I="\0",_e="";class E{constructor(t={}){this._isDirected=p(t,"directed")?t.directed:!0,this._isMultigraph=p(t,"multigraph")?t.multigraph:!1,this._isCompound=p(t,"compound")?t.compound:!1,this._label=void 0,this._defaultNodeLabelFn=D(void 0),this._defaultEdgeLabelFn=D(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[I]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}isDirected(){return this._isDirected}isMultigraph(){return this._isMultigraph}isCompound(){return this._isCompound}setGraph(t){return this._label=t,this}graph(){return this._label}setDefaultNodeLabel(t){return re(t)||(t=D(t)),this._defaultNodeLabelFn=t,this}nodeCount(){return this._nodeCount}nodes(){return M(this._nodes)}sources(){var t=this;return k(this.nodes(),function(r){return ye(t._in[r])})}sinks(){var t=this;return k(this.nodes(),function(r){return ye(t._out[r])})}setNodes(t,r){var n=arguments,i=this;return f(t,function(a){n.length>1?i.setNode(a,r):i.setNode(a)}),this}setNode(t,r){return p(this._nodes,t)?(arguments.length>1&&(this._nodes[t]=r),this):(this._nodes[t]=arguments.length>1?r:this._defaultNodeLabelFn(t),this._isCompound&&(this._parent[t]=I,this._children[t]={},this._children[I][t]=!0),this._in[t]={},this._preds[t]={},this._out[t]={},this._sucs[t]={},++this._nodeCount,this)}node(t){return this._nodes[t]}hasNode(t){return p(this._nodes,t)}removeNode(t){var r=this;if(p(this._nodes,t)){var n=function(i){r.removeEdge(r._edgeObjs[i])};delete this._nodes[t],this._isCompound&&(this._removeFromParentsChildList(t),delete this._parent[t],f(this.children(t),function(i){r.setParent(i)}),delete this._children[t]),f(M(this._in[t]),n),delete this._in[t],delete this._preds[t],f(M(this._out[t]),n),delete this._out[t],delete this._sucs[t],--this._nodeCount}return this}setParent(t,r){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(w(r))r=I;else{r+="";for(var n=r;!w(n);n=this.parent(n))if(n===t)throw new Error("Setting "+r+" as parent of "+t+" would create a cycle");this.setNode(r)}return this.setNode(t),this._removeFromParentsChildList(t),this._parent[t]=r,this._children[r][t]=!0,this}_removeFromParentsChildList(t){delete this._children[this._parent[t]][t]}parent(t){if(this._isCompound){var r=this._parent[t];if(r!==I)return r}}children(t){if(w(t)&&(t=I),this._isCompound){var r=this._children[t];if(r)return M(r)}else{if(t===I)return this.nodes();if(this.hasNode(t))return[]}}predecessors(t){var r=this._preds[t];if(r)return M(r)}successors(t){var r=this._sucs[t];if(r)return M(r)}neighbors(t){var r=this.predecessors(t);if(r)return rt(r,this.successors(t))}isLeaf(t){var r;return this.isDirected()?r=this.successors(t):r=this.neighbors(t),r.length===0}filterNodes(t){var r=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});r.setGraph(this.graph());var n=this;f(this._nodes,function(o,s){t(s)&&r.setNode(s,o)}),f(this._edgeObjs,function(o){r.hasNode(o.v)&&r.hasNode(o.w)&&r.setEdge(o,n.edge(o))});var i={};function a(o){var s=n.parent(o);return s===void 0||r.hasNode(s)?(i[o]=s,s):s in i?i[s]:a(s)}return this._isCompound&&f(r.nodes(),function(o){r.setParent(o,a(o))}),r}setDefaultEdgeLabel(t){return re(t)||(t=D(t)),this._defaultEdgeLabelFn=t,this}edgeCount(){return this._edgeCount}edges(){return L(this._edgeObjs)}setPath(t,r){var n=this,i=arguments;return Y(t,function(a,o){return i.length>1?n.setEdge(a,o,r):n.setEdge(a,o),o}),this}setEdge(){var t,r,n,i,a=!1,o=arguments[0];typeof o=="object"&&o!==null&&"v"in o?(t=o.v,r=o.w,n=o.name,arguments.length===2&&(i=arguments[1],a=!0)):(t=o,r=arguments[1],n=arguments[3],arguments.length>2&&(i=arguments[2],a=!0)),t=""+t,r=""+r,w(n)||(n=""+n);var s=F(this._isDirected,t,r,n);if(p(this._edgeLabels,s))return a&&(this._edgeLabels[s]=i),this;if(!w(n)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(t),this.setNode(r),this._edgeLabels[s]=a?i:this._defaultEdgeLabelFn(t,r,n);var d=vt(this._isDirected,t,r,n);return t=d.v,r=d.w,Object.freeze(d),this._edgeObjs[s]=d,Ee(this._preds[r],t),Ee(this._sucs[t],r),this._in[r][s]=d,this._out[t][s]=d,this._edgeCount++,this}edge(t,r,n){var i=arguments.length===1?q(this._isDirected,arguments[0]):F(this._isDirected,t,r,n);return this._edgeLabels[i]}hasEdge(t,r,n){var i=arguments.length===1?q(this._isDirected,arguments[0]):F(this._isDirected,t,r,n);return p(this._edgeLabels,i)}removeEdge(t,r,n){var i=arguments.length===1?q(this._isDirected,arguments[0]):F(this._isDirected,t,r,n),a=this._edgeObjs[i];return a&&(t=a.v,r=a.w,delete this._edgeLabels[i],delete this._edgeObjs[i],ke(this._preds[r],t),ke(this._sucs[t],r),delete this._in[r][i],delete this._out[t][i],this._edgeCount--),this}inEdges(t,r){var n=this._in[t];if(n){var i=L(n);return r?k(i,function(a){return a.v===r}):i}}outEdges(t,r){var n=this._out[t];if(n){var i=L(n);return r?k(i,function(a){return a.w===r}):i}}nodeEdges(t,r){var n=this.inEdges(t,r);if(n)return n.concat(this.outEdges(t,r))}}E.prototype._nodeCount=0;E.prototype._edgeCount=0;function Ee(e,t){e[t]?e[t]++:e[t]=1}function ke(e,t){--e[t]||delete e[t]}function F(e,t,r,n){var i=""+t,a=""+r;if(!e&&i>a){var o=i;i=a,a=o}return i+_e+a+_e+(w(n)?lt:n)}function vt(e,t,r,n){var i=""+t,a=""+r;if(!e&&i>a){var o=i;i=a,a=o}var s={v:i,w:a};return n&&(s.name=n),s}function q(e,t){return F(e,t.v,t.w,t.name)}class pt{constructor(){var t={};t._next=t._prev=t,this._sentinel=t}dequeue(){var t=this._sentinel,r=t._prev;if(r!==t)return Le(r),r}enqueue(t){var r=this._sentinel;t._prev&&t._next&&Le(t),t._next=r._next,r._next._prev=t,r._next=t,t._prev=r}toString(){for(var t=[],r=this._sentinel,n=r._prev;n!==r;)t.push(JSON.stringify(n,gt)),n=n._prev;return"["+t.join(", ")+"]"}}function Le(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function gt(e,t){if(e!=="_next"&&e!=="_prev")return t}var mt=D(1);function wt(e,t){if(e.nodeCount()<=1)return[];var r=yt(e,t||mt),n=bt(r.graph,r.buckets,r.zeroIdx);return W(b(n,function(i){return e.outEdges(i.v,i.w)}))}function bt(e,t,r){for(var n=[],i=t[t.length-1],a=t[0],o;e.nodeCount();){for(;o=a.dequeue();)J(e,t,r,o);for(;o=i.dequeue();)J(e,t,r,o);if(e.nodeCount()){for(var s=t.length-2;s>0;--s)if(o=t[s].dequeue(),o){n=n.concat(J(e,t,r,o,!0));break}}}return n}function J(e,t,r,n,i){var a=i?[]:void 0;return f(e.inEdges(n.v),function(o){var s=e.edge(o),d=e.node(o.v);i&&a.push({v:o.v,w:o.w}),d.out-=s,ie(t,r,d)}),f(e.outEdges(n.v),function(o){var s=e.edge(o),d=o.w,u=e.node(d);u.in-=s,ie(t,r,u)}),e.removeNode(n.v),a}function yt(e,t){var r=new E,n=0,i=0;f(e.nodes(),function(s){r.setNode(s,{v:s,in:0,out:0})}),f(e.edges(),function(s){var d=r.edge(s.v,s.w)||0,u=t(s),h=d+u;r.setEdge(s.v,s.w,h),i=Math.max(i,r.node(s.v).out+=u),n=Math.max(n,r.node(s.w).in+=u)});var a=T(i+n+3).map(function(){return new pt}),o=n+1;return f(r.nodes(),function(s){ie(a,o,r.node(s))}),{graph:r,buckets:a,zeroIdx:o}}function ie(e,t,r){r.out?r.in?e[r.out-r.in+t].enqueue(r):e[e.length-1].enqueue(r):e[0].enqueue(r)}function xt(e){var t=e.graph().acyclicer==="greedy"?wt(e,r(e)):_t(e);f(t,function(n){var i=e.edge(n);e.removeEdge(n),i.forwardName=n.name,i.reversed=!0,e.setEdge(n.w,n.v,i,X("rev"))});function r(n){return function(i){return n.edge(i).weight}}}function _t(e){var t=[],r={},n={};function i(a){p(n,a)||(n[a]=!0,r[a]=!0,f(e.outEdges(a),function(o){p(r,o.w)?t.push(o):i(o.w)}),delete r[a])}return f(e.nodes(),i),t}function Et(e){f(e.edges(),function(t){var r=e.edge(t);if(r.reversed){e.removeEdge(t);var n=r.forwardName;delete r.reversed,delete r.forwardName,e.setEdge(t.w,t.v,r,n)}})}function O(e,t,r,n){var i;do i=X(n);while(e.hasNode(i));return r.dummy=t,e.setNode(i,r),i}function kt(e){var t=new E().setGraph(e.graph());return f(e.nodes(),function(r){t.setNode(r,e.node(r))}),f(e.edges(),function(r){var n=t.edge(r.v,r.w)||{weight:0,minlen:1},i=e.edge(r);t.setEdge(r.v,r.w,{weight:n.weight+i.weight,minlen:Math.max(n.minlen,i.minlen)})}),t}function De(e){var t=new E({multigraph:e.isMultigraph()}).setGraph(e.graph());return f(e.nodes(),function(r){e.children(r).length||t.setNode(r,e.node(r))}),f(e.edges(),function(r){t.setEdge(r,e.edge(r))}),t}function Ne(e,t){var r=e.x,n=e.y,i=t.x-r,a=t.y-n,o=e.width/2,s=e.height/2;if(!i&&!a)throw new Error("Not possible to find intersection inside of the rectangle");var d,u;return Math.abs(a)*o>Math.abs(i)*s?(a<0&&(s=-s),d=s*i/a,u=s):(i<0&&(o=-o),d=o,u=o*a/i),{x:r+d,y:n+u}}function z(e){var t=b(T(Fe(e)+1),function(){return[]});return f(e.nodes(),function(r){var n=e.node(r),i=n.rank;w(i)||(t[i][n.order]=r)}),t}function Lt(e){var t=G(b(e.nodes(),function(r){return e.node(r).rank}));f(e.nodes(),function(r){var n=e.node(r);p(n,"rank")&&(n.rank-=t)})}function Nt(e){var t=G(b(e.nodes(),function(a){return e.node(a).rank})),r=[];f(e.nodes(),function(a){var o=e.node(a).rank-t;r[o]||(r[o]=[]),r[o].push(a)});var n=0,i=e.graph().nodeRankFactor;f(r,function(a,o){w(a)&&o%i!==0?--n:n&&f(a,function(s){e.node(s).rank+=n})})}function Ce(e,t,r,n){var i={width:0,height:0};return arguments.length>=4&&(i.rank=r,i.order=n),O(e,"border",i,t)}function Fe(e){return S(b(e.nodes(),function(t){var r=e.node(t).rank;if(!w(r))return r}))}function Ct(e,t){var r={lhs:[],rhs:[]};return f(e,function(n){t(n)?r.lhs.push(n):r.rhs.push(n)}),r}function It(e,t){var r=xe();try{return t()}finally{console.log(e+" time: "+(xe()-r)+"ms")}}function Tt(e,t){return t()}function St(e){function t(r){var n=e.children(r),i=e.node(r);if(n.length&&f(n,t),p(i,"minRank")){i.borderLeft=[],i.borderRight=[];for(var a=i.minRank,o=i.maxRank+1;a<o;++a)Ie(e,"borderLeft","_bl",r,i,a),Ie(e,"borderRight","_br",r,i,a)}}f(e.children(),t)}function Ie(e,t,r,n,i,a){var o={width:0,height:0,rank:a,borderType:t},s=i[t][a-1],d=O(e,"border",o,r);i[t][a]=d,e.setParent(d,n),s&&e.setEdge(s,d,{weight:1})}function Rt(e){var t=e.graph().rankdir.toLowerCase();(t==="lr"||t==="rl")&&Ge(e)}function Mt(e){var t=e.graph().rankdir.toLowerCase();(t==="bt"||t==="rl")&&Pt(e),(t==="lr"||t==="rl")&&(Ot(e),Ge(e))}function Ge(e){f(e.nodes(),function(t){Te(e.node(t))}),f(e.edges(),function(t){Te(e.edge(t))})}function Te(e){var t=e.width;e.width=e.height,e.height=t}function Pt(e){f(e.nodes(),function(t){K(e.node(t))}),f(e.edges(),function(t){var r=e.edge(t);f(r.points,K),p(r,"y")&&K(r)})}function K(e){e.y=-e.y}function Ot(e){f(e.nodes(),function(t){Q(e.node(t))}),f(e.edges(),function(t){var r=e.edge(t);f(r.points,Q),p(r,"x")&&Q(r)})}function Q(e){var t=e.x;e.x=e.y,e.y=t}function Bt(e){e.graph().dummyChains=[],f(e.edges(),function(t){At(e,t)})}function At(e,t){var r=t.v,n=e.node(r).rank,i=t.w,a=e.node(i).rank,o=t.name,s=e.edge(t),d=s.labelRank;if(a!==n+1){e.removeEdge(t);var u,h,c;for(c=0,++n;n<a;++c,++n)s.points=[],h={width:0,height:0,edgeLabel:s,edgeObj:t,rank:n},u=O(e,"edge",h,"_d"),n===d&&(h.width=s.width,h.height=s.height,h.dummy="edge-label",h.labelpos=s.labelpos),e.setEdge(r,u,{weight:s.weight},o),c===0&&e.graph().dummyChains.push(u),r=u;e.setEdge(r,i,{weight:s.weight},o)}}function Dt(e){f(e.graph().dummyChains,function(t){var r=e.node(t),n=r.edgeLabel,i;for(e.setEdge(r.edgeObj,n);r.dummy;)i=e.successors(t)[0],e.removeNode(t),n.points.push({x:r.x,y:r.y}),r.dummy==="edge-label"&&(n.x=r.x,n.y=r.y,n.width=r.width,n.height=r.height),t=i,r=e.node(t)})}function le(e){var t={};function r(n){var i=e.node(n);if(p(t,n))return i.rank;t[n]=!0;var a=G(b(e.outEdges(n),function(o){return r(o.w)-e.edge(o).minlen}));return(a===Number.POSITIVE_INFINITY||a===void 0||a===null)&&(a=0),i.rank=a}f(e.sources(),r)}function j(e,t){return e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen}function Ve(e){var t=new E({directed:!1}),r=e.nodes()[0],n=e.nodeCount();t.setNode(r,{});for(var i,a;Ft(t,e)<n;)i=Gt(t,e),a=t.hasNode(i.v)?j(e,i):-j(e,i),Vt(t,e,a);return t}function Ft(e,t){function r(n){f(t.nodeEdges(n),function(i){var a=i.v,o=n===a?i.w:a;!e.hasNode(o)&&!j(t,i)&&(e.setNode(o,{}),e.setEdge(n,o,{}),r(o))})}return f(e.nodes(),r),e.nodeCount()}function Gt(e,t){return he(t.edges(),function(r){if(e.hasNode(r.v)!==e.hasNode(r.w))return j(t,r)})}function Vt(e,t,r){f(e.nodes(),function(n){t.node(n).rank+=r})}function jt(){}jt.prototype=new Error;function je(e,t,r){nt(t)||(t=[t]);var n=(e.isDirected()?e.successors:e.neighbors).bind(e),i=[],a={};return f(t,function(o){if(!e.hasNode(o))throw new Error("Graph does not have node: "+o);Ye(e,o,r==="post",a,n,i)}),i}function Ye(e,t,r,n,i,a){p(n,t)||(n[t]=!0,r||a.push(t),f(i(t),function(o){Ye(e,o,r,n,i,a)}),r&&a.push(t))}function Yt(e,t){return je(e,t,"post")}function Wt(e,t){return je(e,t,"pre")}R.initLowLimValues=pe;R.initCutValues=ve;R.calcCutValue=We;R.leaveEdge=Ue;R.enterEdge=Xe;R.exchangeEdges=$e;function R(e){e=kt(e),le(e);var t=Ve(e);pe(t),ve(t,e);for(var r,n;r=Ue(t);)n=Xe(t,e,r),$e(t,e,r,n)}function ve(e,t){var r=Yt(e,e.nodes());r=r.slice(0,r.length-1),f(r,function(n){Ht(e,t,n)})}function Ht(e,t,r){var n=e.node(r),i=n.parent;e.edge(r,i).cutvalue=We(e,t,r)}function We(e,t,r){var n=e.node(r),i=n.parent,a=!0,o=t.edge(r,i),s=0;return o||(a=!1,o=t.edge(i,r)),s=o.weight,f(t.nodeEdges(r),function(d){var u=d.v===r,h=u?d.w:d.v;if(h!==i){var c=u===a,l=t.edge(d).weight;if(s+=c?l:-l,Xt(e,r,h)){var g=e.edge(r,h).cutvalue;s+=c?-g:g}}}),s}function pe(e,t){arguments.length<2&&(t=e.nodes()[0]),He(e,{},1,t)}function He(e,t,r,n,i){var a=r,o=e.node(n);return t[n]=!0,f(e.neighbors(n),function(s){p(t,s)||(r=He(e,t,r,s,n))}),o.low=a,o.lim=r++,i?o.parent=i:delete o.parent,r}function Ue(e){return ce(e.edges(),function(t){return e.edge(t).cutvalue<0})}function Xe(e,t,r){var n=r.v,i=r.w;t.hasEdge(n,i)||(n=r.w,i=r.v);var a=e.node(n),o=e.node(i),s=a,d=!1;a.lim>o.lim&&(s=o,d=!0);var u=k(t.edges(),function(h){return d===Se(e,e.node(h.v),s)&&d!==Se(e,e.node(h.w),s)});return he(u,function(h){return j(t,h)})}function $e(e,t,r,n){var i=r.v,a=r.w;e.removeEdge(i,a),e.setEdge(n.v,n.w,{}),pe(e),ve(e,t),Ut(e,t)}function Ut(e,t){var r=ce(e.nodes(),function(i){return!t.node(i).parent}),n=Wt(e,r);n=n.slice(1),f(n,function(i){var a=e.node(i).parent,o=t.edge(i,a),s=!1;o||(o=t.edge(a,i),s=!0),t.node(i).rank=t.node(a).rank+(s?o.minlen:-o.minlen)})}function Xt(e,t,r){return e.hasEdge(t,r)}function Se(e,t,r){return r.low<=t.lim&&t.lim<=r.lim}function $t(e){switch(e.graph().ranker){case"network-simplex":Re(e);break;case"tight-tree":qt(e);break;case"longest-path":zt(e);break;default:Re(e)}}var zt=le;function qt(e){le(e),Ve(e)}function Re(e){R(e)}function Jt(e){var t=O(e,"root",{},"_root"),r=Kt(e),n=S(L(r))-1,i=2*n+1;e.graph().nestingRoot=t,f(e.edges(),function(o){e.edge(o).minlen*=i});var a=Qt(e)+1;f(e.children(),function(o){ze(e,t,i,a,n,r,o)}),e.graph().nodeRankFactor=i}function ze(e,t,r,n,i,a,o){var s=e.children(o);if(!s.length){o!==t&&e.setEdge(t,o,{weight:0,minlen:r});return}var d=Ce(e,"_bt"),u=Ce(e,"_bb"),h=e.node(o);e.setParent(d,o),h.borderTop=d,e.setParent(u,o),h.borderBottom=u,f(s,function(c){ze(e,t,r,n,i,a,c);var l=e.node(c),g=l.borderTop?l.borderTop:c,v=l.borderBottom?l.borderBottom:c,m=l.borderTop?n:2*n,y=g!==v?1:i-a[o]+1;e.setEdge(d,g,{weight:m,minlen:y,nestingEdge:!0}),e.setEdge(v,u,{weight:m,minlen:y,nestingEdge:!0})}),e.parent(o)||e.setEdge(t,d,{weight:0,minlen:i+a[o]})}function Kt(e){var t={};function r(n,i){var a=e.children(n);a&&a.length&&f(a,function(o){r(o,i+1)}),t[n]=i}return f(e.children(),function(n){r(n,1)}),t}function Qt(e){return Y(e.edges(),function(t,r){return t+e.edge(r).weight},0)}function Zt(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,f(e.edges(),function(r){var n=e.edge(r);n.nestingEdge&&e.removeEdge(r)})}function er(e,t,r){var n={},i;f(r,function(a){for(var o=e.parent(a),s,d;o;){if(s=e.parent(o),s?(d=n[s],n[s]=o):(d=i,i=o),d&&d!==o){t.setEdge(d,o);return}o=s}})}function tr(e,t,r){var n=rr(e),i=new E({compound:!0}).setGraph({root:n}).setDefaultNodeLabel(function(a){return e.node(a)});return f(e.nodes(),function(a){var o=e.node(a),s=e.parent(a);(o.rank===t||o.minRank<=t&&t<=o.maxRank)&&(i.setNode(a),i.setParent(a,s||n),f(e[r](a),function(d){var u=d.v===a?d.w:d.v,h=i.edge(u,a),c=w(h)?0:h.weight;i.setEdge(u,a,{weight:e.edge(d).weight+c})}),p(o,"minRank")&&i.setNode(a,{borderLeft:o.borderLeft[t],borderRight:o.borderRight[t]}))}),i}function rr(e){for(var t;e.hasNode(t=X("_root")););return t}function nr(e,t){for(var r=0,n=1;n<t.length;++n)r+=ir(e,t[n-1],t[n]);return r}function ir(e,t,r){for(var n=it(r,b(r,function(u,h){return h})),i=W(b(t,function(u){return H(b(e.outEdges(u),function(h){return{pos:n[h.w],weight:e.edge(h).weight}}),"pos")})),a=1;a<r.length;)a<<=1;var o=2*a-1;a-=1;var s=b(new Array(o),function(){return 0}),d=0;return f(i.forEach(function(u){var h=u.pos+a;s[h]+=u.weight;for(var c=0;h>0;)h%2&&(c+=s[h+1]),h=h-1>>1,s[h]+=u.weight;d+=u.weight*c})),d}function ar(e){var t={},r=k(e.nodes(),function(s){return!e.children(s).length}),n=S(b(r,function(s){return e.node(s).rank})),i=b(T(n+1),function(){return[]});function a(s){if(!p(t,s)){t[s]=!0;var d=e.node(s);i[d.rank].push(s),f(e.successors(s),a)}}var o=H(r,function(s){return e.node(s).rank});return f(o,a),i}function or(e,t){return b(t,function(r){var n=e.inEdges(r);if(n.length){var i=Y(n,function(a,o){var s=e.edge(o),d=e.node(o.v);return{sum:a.sum+s.weight*d.order,weight:a.weight+s.weight}},{sum:0,weight:0});return{v:r,barycenter:i.sum/i.weight,weight:i.weight}}else return{v:r}})}function sr(e,t){var r={};f(e,function(i,a){var o=r[i.v]={indegree:0,in:[],out:[],vs:[i.v],i:a};w(i.barycenter)||(o.barycenter=i.barycenter,o.weight=i.weight)}),f(t.edges(),function(i){var a=r[i.v],o=r[i.w];!w(a)&&!w(o)&&(o.indegree++,a.out.push(r[i.w]))});var n=k(r,function(i){return!i.indegree});return dr(n)}function dr(e){var t=[];function r(a){return function(o){o.merged||(w(o.barycenter)||w(a.barycenter)||o.barycenter>=a.barycenter)&&ur(a,o)}}function n(a){return function(o){o.in.push(a),--o.indegree===0&&e.push(o)}}for(;e.length;){var i=e.pop();t.push(i),f(i.in.reverse(),r(i)),f(i.out,n(i))}return b(k(t,function(a){return!a.merged}),function(a){return V(a,["vs","i","barycenter","weight"])})}function ur(e,t){var r=0,n=0;e.weight&&(r+=e.barycenter*e.weight,n+=e.weight),t.weight&&(r+=t.barycenter*t.weight,n+=t.weight),e.vs=t.vs.concat(e.vs),e.barycenter=r/n,e.weight=n,e.i=Math.min(t.i,e.i),t.merged=!0}function fr(e,t){var r=Ct(e,function(h){return p(h,"barycenter")}),n=r.lhs,i=H(r.rhs,function(h){return-h.i}),a=[],o=0,s=0,d=0;n.sort(hr(!!t)),d=Me(a,i,d),f(n,function(h){d+=h.vs.length,a.push(h.vs),o+=h.barycenter*h.weight,s+=h.weight,d=Me(a,i,d)});var u={vs:W(a)};return s&&(u.barycenter=o/s,u.weight=s),u}function Me(e,t,r){for(var n;t.length&&(n=U(t)).i<=r;)t.pop(),e.push(n.vs),r++;return r}function hr(e){return function(t,r){return t.barycenter<r.barycenter?-1:t.barycenter>r.barycenter?1:e?r.i-t.i:t.i-r.i}}function qe(e,t,r,n){var i=e.children(t),a=e.node(t),o=a?a.borderLeft:void 0,s=a?a.borderRight:void 0,d={};o&&(i=k(i,function(v){return v!==o&&v!==s}));var u=or(e,i);f(u,function(v){if(e.children(v.v).length){var m=qe(e,v.v,r,n);d[v.v]=m,p(m,"barycenter")&&lr(v,m)}});var h=sr(u,r);cr(h,d);var c=fr(h,n);if(o&&(c.vs=W([o,c.vs,s]),e.predecessors(o).length)){var l=e.node(e.predecessors(o)[0]),g=e.node(e.predecessors(s)[0]);p(c,"barycenter")||(c.barycenter=0,c.weight=0),c.barycenter=(c.barycenter*c.weight+l.order+g.order)/(c.weight+2),c.weight+=2}return c}function cr(e,t){f(e,function(r){r.vs=W(r.vs.map(function(n){return t[n]?t[n].vs:n}))})}function lr(e,t){w(e.barycenter)?(e.barycenter=t.barycenter,e.weight=t.weight):(e.barycenter=(e.barycenter*e.weight+t.barycenter*t.weight)/(e.weight+t.weight),e.weight+=t.weight)}function vr(e){var t=Fe(e),r=Pe(e,T(1,t+1),"inEdges"),n=Pe(e,T(t-1,-1,-1),"outEdges"),i=ar(e);Oe(e,i);for(var a=Number.POSITIVE_INFINITY,o,s=0,d=0;d<4;++s,++d){pr(s%2?r:n,s%4>=2),i=z(e);var u=nr(e,i);u<a&&(d=0,o=at(i),a=u)}Oe(e,o)}function Pe(e,t,r){return b(t,function(n){return tr(e,n,r)})}function pr(e,t){var r=new E;f(e,function(n){var i=n.graph().root,a=qe(n,i,r,t);f(a.vs,function(o,s){n.node(o).order=s}),er(n,r,a.vs)})}function Oe(e,t){f(t,function(r){f(r,function(n,i){e.node(n).order=i})})}function gr(e){var t=wr(e);f(e.graph().dummyChains,function(r){for(var n=e.node(r),i=n.edgeObj,a=mr(e,t,i.v,i.w),o=a.path,s=a.lca,d=0,u=o[d],h=!0;r!==i.w;){if(n=e.node(r),h){for(;(u=o[d])!==s&&e.node(u).maxRank<n.rank;)d++;u===s&&(h=!1)}if(!h){for(;d<o.length-1&&e.node(u=o[d+1]).minRank<=n.rank;)d++;u=o[d]}e.setParent(r,u),r=e.successors(r)[0]}})}function mr(e,t,r,n){var i=[],a=[],o=Math.min(t[r].low,t[n].low),s=Math.max(t[r].lim,t[n].lim),d,u;d=r;do d=e.parent(d),i.push(d);while(d&&(t[d].low>o||s>t[d].lim));for(u=d,d=n;(d=e.parent(d))!==u;)a.push(d);return{path:i.concat(a.reverse()),lca:u}}function wr(e){var t={},r=0;function n(i){var a=r;f(e.children(i),n),t[i]={low:a,lim:r++}}return f(e.children(),n),t}function br(e,t){var r={};function n(i,a){var o=0,s=0,d=i.length,u=U(a);return f(a,function(h,c){var l=xr(e,h),g=l?e.node(l).order:d;(l||h===u)&&(f(a.slice(s,c+1),function(v){f(e.predecessors(v),function(m){var y=e.node(m),C=y.order;(C<o||g<C)&&!(y.dummy&&e.node(v).dummy)&&Je(r,m,v)})}),s=c+1,o=g)}),a}return Y(t,n),r}function yr(e,t){var r={};function n(a,o,s,d,u){var h;f(T(o,s),function(c){h=a[c],e.node(h).dummy&&f(e.predecessors(h),function(l){var g=e.node(l);g.dummy&&(g.order<d||g.order>u)&&Je(r,l,h)})})}function i(a,o){var s=-1,d,u=0;return f(o,function(h,c){if(e.node(h).dummy==="border"){var l=e.predecessors(h);l.length&&(d=e.node(l[0]).order,n(o,u,c,s,d),u=c,s=d)}n(o,u,o.length,d,a.length)}),o}return Y(t,i),r}function xr(e,t){if(e.node(t).dummy)return ce(e.predecessors(t),function(r){return e.node(r).dummy})}function Je(e,t,r){if(t>r){var n=t;t=r,r=n}var i=e[t];i||(e[t]=i={}),i[r]=!0}function _r(e,t,r){if(t>r){var n=t;t=r,r=n}return p(e[t],r)}function Er(e,t,r,n){var i={},a={},o={};return f(t,function(s){f(s,function(d,u){i[d]=d,a[d]=d,o[d]=u})}),f(t,function(s){var d=-1;f(s,function(u){var h=n(u);if(h.length){h=H(h,function(m){return o[m]});for(var c=(h.length-1)/2,l=Math.floor(c),g=Math.ceil(c);l<=g;++l){var v=h[l];a[u]===u&&d<o[v]&&!_r(r,u,v)&&(a[v]=u,a[u]=i[u]=i[v],d=o[v])}}})}),{root:i,align:a}}function kr(e,t,r,n,i){var a={},o=Lr(e,t,r,i),s=i?"borderLeft":"borderRight";function d(c,l){for(var g=o.nodes(),v=g.pop(),m={};v;)m[v]?c(v):(m[v]=!0,g.push(v),g=g.concat(l(v))),v=g.pop()}function u(c){a[c]=o.inEdges(c).reduce(function(l,g){return Math.max(l,a[g.v]+o.edge(g))},0)}function h(c){var l=o.outEdges(c).reduce(function(v,m){return Math.min(v,a[m.w]-o.edge(m))},Number.POSITIVE_INFINITY),g=e.node(c);l!==Number.POSITIVE_INFINITY&&g.borderType!==s&&(a[c]=Math.max(a[c],l))}return d(u,o.predecessors.bind(o)),d(h,o.successors.bind(o)),f(n,function(c){a[c]=a[r[c]]}),a}function Lr(e,t,r,n){var i=new E,a=e.graph(),o=Sr(a.nodesep,a.edgesep,n);return f(t,function(s){var d;f(s,function(u){var h=r[u];if(i.setNode(h),d){var c=r[d],l=i.edge(c,h);i.setEdge(c,h,Math.max(o(e,u,d),l||0))}d=u})}),i}function Nr(e,t){return he(L(t),function(r){var n=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY;return ot(r,function(a,o){var s=Rr(e,o)/2;n=Math.max(a+s,n),i=Math.min(a-s,i)}),n-i})}function Cr(e,t){var r=L(t),n=G(r),i=S(r);f(["u","d"],function(a){f(["l","r"],function(o){var s=a+o,d=e[s],u;if(d!==t){var h=L(d);u=o==="l"?n-G(h):i-S(h),u&&(e[s]=$(d,function(c){return c+u}))}})})}function Ir(e,t){return $(e.ul,function(r,n){if(t)return e[t.toLowerCase()][n];var i=H(b(e,n));return(i[1]+i[2])/2})}function Tr(e){var t=z(e),r=ne(br(e,t),yr(e,t)),n={},i;f(["u","d"],function(o){i=o==="u"?t:L(t).reverse(),f(["l","r"],function(s){s==="r"&&(i=b(i,function(c){return L(c).reverse()}));var d=(o==="u"?e.predecessors:e.successors).bind(e),u=Er(e,i,r,d),h=kr(e,i,u.root,u.align,s==="r");s==="r"&&(h=$(h,function(c){return-c})),n[o+s]=h})});var a=Nr(e,n);return Cr(n,a),Ir(n,e.graph().align)}function Sr(e,t,r){return function(n,i,a){var o=n.node(i),s=n.node(a),d=0,u;if(d+=o.width/2,p(o,"labelpos"))switch(o.labelpos.toLowerCase()){case"l":u=-o.width/2;break;case"r":u=o.width/2;break}if(u&&(d+=r?u:-u),u=0,d+=(o.dummy?t:e)/2,d+=(s.dummy?t:e)/2,d+=s.width/2,p(s,"labelpos"))switch(s.labelpos.toLowerCase()){case"l":u=s.width/2;break;case"r":u=-s.width/2;break}return u&&(d+=r?u:-u),u=0,d}}function Rr(e,t){return e.node(t).width}function Mr(e){e=De(e),Pr(e),st(Tr(e),function(t,r){e.node(r).x=t})}function Pr(e){var t=z(e),r=e.graph().ranksep,n=0;f(t,function(i){var a=S(b(i,function(o){return e.node(o).height}));f(i,function(o){e.node(o).y=n+a/2}),n+=a+r})}function Or(e,t){var r=t&&t.debugTiming?It:Tt;r("layout",function(){var n=r("  buildLayoutGraph",function(){return Ur(e)});r("  runLayout",function(){Br(n,r)}),r("  updateInputGraph",function(){Ar(e,n)})})}function Br(e,t){t("    makeSpaceForEdgeLabels",function(){Xr(e)}),t("    removeSelfEdges",function(){tn(e)}),t("    acyclic",function(){xt(e)}),t("    nestingGraph.run",function(){Jt(e)}),t("    rank",function(){$t(De(e))}),t("    injectEdgeLabelProxies",function(){$r(e)}),t("    removeEmptyRanks",function(){Nt(e)}),t("    nestingGraph.cleanup",function(){Zt(e)}),t("    normalizeRanks",function(){Lt(e)}),t("    assignRankMinMax",function(){zr(e)}),t("    removeEdgeLabelProxies",function(){qr(e)}),t("    normalize.run",function(){Bt(e)}),t("    parentDummyChains",function(){gr(e)}),t("    addBorderSegments",function(){St(e)}),t("    order",function(){vr(e)}),t("    insertSelfEdges",function(){rn(e)}),t("    adjustCoordinateSystem",function(){Rt(e)}),t("    position",function(){Mr(e)}),t("    positionSelfEdges",function(){nn(e)}),t("    removeBorderNodes",function(){en(e)}),t("    normalize.undo",function(){Dt(e)}),t("    fixupEdgeLabelCoords",function(){Qr(e)}),t("    undoCoordinateSystem",function(){Mt(e)}),t("    translateGraph",function(){Jr(e)}),t("    assignNodeIntersects",function(){Kr(e)}),t("    reversePoints",function(){Zr(e)}),t("    acyclic.undo",function(){Et(e)})}function Ar(e,t){f(e.nodes(),function(r){var n=e.node(r),i=t.node(r);n&&(n.x=i.x,n.y=i.y,t.children(r).length&&(n.width=i.width,n.height=i.height))}),f(e.edges(),function(r){var n=e.edge(r),i=t.edge(r);n.points=i.points,p(i,"x")&&(n.x=i.x,n.y=i.y)}),e.graph().width=t.graph().width,e.graph().height=t.graph().height}var Dr=["nodesep","edgesep","ranksep","marginx","marginy"],Fr={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},Gr=["acyclicer","ranker","rankdir","align"],Vr=["width","height"],jr={width:0,height:0},Yr=["minlen","weight","width","height","labeloffset"],Wr={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},Hr=["labelpos"];function Ur(e){var t=new E({multigraph:!0,compound:!0}),r=ee(e.graph());return t.setGraph(ne({},Fr,Z(r,Dr),V(r,Gr))),f(e.nodes(),function(n){var i=ee(e.node(n));t.setNode(n,P(Z(i,Vr),jr)),t.setParent(n,e.parent(n))}),f(e.edges(),function(n){var i=ee(e.edge(n));t.setEdge(n,ne({},Wr,Z(i,Yr),V(i,Hr)))}),t}function Xr(e){var t=e.graph();t.ranksep/=2,f(e.edges(),function(r){var n=e.edge(r);n.minlen*=2,n.labelpos.toLowerCase()!=="c"&&(t.rankdir==="TB"||t.rankdir==="BT"?n.width+=n.labeloffset:n.height+=n.labeloffset)})}function $r(e){f(e.edges(),function(t){var r=e.edge(t);if(r.width&&r.height){var n=e.node(t.v),i=e.node(t.w),a={rank:(i.rank-n.rank)/2+n.rank,e:t};O(e,"edge-proxy",a,"_ep")}})}function zr(e){var t=0;f(e.nodes(),function(r){var n=e.node(r);n.borderTop&&(n.minRank=e.node(n.borderTop).rank,n.maxRank=e.node(n.borderBottom).rank,t=S(t,n.maxRank))}),e.graph().maxRank=t}function qr(e){f(e.nodes(),function(t){var r=e.node(t);r.dummy==="edge-proxy"&&(e.edge(r.e).labelRank=r.rank,e.removeNode(t))})}function Jr(e){var t=Number.POSITIVE_INFINITY,r=0,n=Number.POSITIVE_INFINITY,i=0,a=e.graph(),o=a.marginx||0,s=a.marginy||0;function d(u){var h=u.x,c=u.y,l=u.width,g=u.height;t=Math.min(t,h-l/2),r=Math.max(r,h+l/2),n=Math.min(n,c-g/2),i=Math.max(i,c+g/2)}f(e.nodes(),function(u){d(e.node(u))}),f(e.edges(),function(u){var h=e.edge(u);p(h,"x")&&d(h)}),t-=o,n-=s,f(e.nodes(),function(u){var h=e.node(u);h.x-=t,h.y-=n}),f(e.edges(),function(u){var h=e.edge(u);f(h.points,function(c){c.x-=t,c.y-=n}),p(h,"x")&&(h.x-=t),p(h,"y")&&(h.y-=n)}),a.width=r-t+o,a.height=i-n+s}function Kr(e){f(e.edges(),function(t){var r=e.edge(t),n=e.node(t.v),i=e.node(t.w),a,o;r.points?(a=r.points[0],o=r.points[r.points.length-1]):(r.points=[],a=i,o=n),r.points.unshift(Ne(n,a)),r.points.push(Ne(i,o))})}function Qr(e){f(e.edges(),function(t){var r=e.edge(t);if(p(r,"x"))switch((r.labelpos==="l"||r.labelpos==="r")&&(r.width-=r.labeloffset),r.labelpos){case"l":r.x-=r.width/2+r.labeloffset;break;case"r":r.x+=r.width/2+r.labeloffset;break}})}function Zr(e){f(e.edges(),function(t){var r=e.edge(t);r.reversed&&r.points.reverse()})}function en(e){f(e.nodes(),function(t){if(e.children(t).length){var r=e.node(t),n=e.node(r.borderTop),i=e.node(r.borderBottom),a=e.node(U(r.borderLeft)),o=e.node(U(r.borderRight));r.width=Math.abs(o.x-a.x),r.height=Math.abs(i.y-n.y),r.x=a.x+r.width/2,r.y=n.y+r.height/2}}),f(e.nodes(),function(t){e.node(t).dummy==="border"&&e.removeNode(t)})}function tn(e){f(e.edges(),function(t){if(t.v===t.w){var r=e.node(t.v);r.selfEdges||(r.selfEdges=[]),r.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdge(t)}})}function rn(e){var t=z(e);f(t,function(r){var n=0;f(r,function(i,a){var o=e.node(i);o.order=a+n,f(o.selfEdges,function(s){O(e,"selfedge",{width:s.label.width,height:s.label.height,rank:o.rank,order:a+ ++n,e:s.e,label:s.label},"_se")}),delete o.selfEdges})})}function nn(e){f(e.nodes(),function(t){var r=e.node(t);if(r.dummy==="selfedge"){var n=e.node(r.e.v),i=n.x+n.width/2,a=n.y,o=r.x-i,s=n.height/2;e.setEdge(r.e,r.label),e.removeNode(t),r.label.points=[{x:i+2*o/3,y:a-s},{x:i+5*o/6,y:a-s},{x:i+o,y:a},{x:i+5*o/6,y:a+s},{x:i+2*o/3,y:a+s}],r.label.x=r.x,r.label.y=r.y}})}function Z(e,t){return $(V(e,t),Number)}function ee(e){var t={};return f(e,function(r,n){t[n.toLowerCase()]=r}),t}function Ke(e,t){return!!e.children(t).length}function Qe(e){return te(e.v)+":"+te(e.w)+":"+te(e.name)}var an=/:/g;function te(e){return e?String(e).replace(an,"\\:"):""}function N(e,t){t&&e.attr("style",t)}function Ze(e,t,r){t&&e.attr("class",t).attr("class",r+" "+e.attr("class"))}function _(e,t){var r=t.graph();if(dt(r)){var n=r.transition;if(re(n))return n(e)}return e}var ae={normal:sn,vee:dn,undirected:un};function on(e){ae=e}function sn(e,t,r,n){var i=e.append("marker").attr("id",t).attr("viewBox","0 0 10 10").attr("refX",9).attr("refY",5).attr("markerUnits","strokeWidth").attr("markerWidth",8).attr("markerHeight",6).attr("orient","auto"),a=i.append("path").attr("d","M 0 0 L 10 5 L 0 10 z").style("stroke-width",1).style("stroke-dasharray","1,0");N(a,r[n+"Style"]),r[n+"Class"]&&a.attr("class",r[n+"Class"])}function dn(e,t,r,n){var i=e.append("marker").attr("id",t).attr("viewBox","0 0 10 10").attr("refX",9).attr("refY",5).attr("markerUnits","strokeWidth").attr("markerWidth",8).attr("markerHeight",6).attr("orient","auto"),a=i.append("path").attr("d","M 0 0 L 10 5 L 0 10 L 4 5 z").style("stroke-width",1).style("stroke-dasharray","1,0");N(a,r[n+"Style"]),r[n+"Class"]&&a.attr("class",r[n+"Class"])}function un(e,t,r,n){var i=e.append("marker").attr("id",t).attr("viewBox","0 0 10 10").attr("refX",9).attr("refY",5).attr("markerUnits","strokeWidth").attr("markerWidth",8).attr("markerHeight",6).attr("orient","auto"),a=i.append("path").attr("d","M 0 5 L 10 5").style("stroke-width",1).style("stroke-dasharray","1,0");N(a,r[n+"Style"]),r[n+"Class"]&&a.attr("class",r[n+"Class"])}function fn(e,t){var r=e.append("foreignObject").attr("width","100000"),n=r.append("xhtml:div");n.attr("xmlns","http://www.w3.org/1999/xhtml");var i=t.label;switch(typeof i){case"function":n.insert(i);break;case"object":n.insert(function(){return i});break;default:n.html(i)}N(n,t.labelStyle),n.style("display","inline-block"),n.style("white-space","nowrap");var a=n.node().getBoundingClientRect();return r.attr("width",a.width).attr("height",a.height),r}function hn(e,t){var r=e;return r.node().appendChild(t.label),N(r,t.labelStyle),r}function cn(e,t){for(var r=e.append("text"),n=ln(t.label).split(`
`),i=0;i<n.length;i++)r.append("tspan").attr("xml:space","preserve").attr("dy","1em").attr("x","1").text(n[i]);return N(r,t.labelStyle),r}function ln(e){for(var t="",r=!1,n,i=0;i<e.length;++i)if(n=e[i],r){switch(n){case"n":t+=`
`;break;default:t+=n}r=!1}else n==="\\"?r=!0:t+=n;return t}function ge(e,t,r){var n=t.label,i=e.append("g");t.labelType==="svg"?hn(i,t):typeof n!="string"||t.labelType==="html"?fn(i,t):cn(i,t);var a=i.node().getBBox(),o;switch(r){case"top":o=-t.height/2;break;case"bottom":o=t.height/2-a.height;break;default:o=-a.height/2}return i.attr("transform","translate("+-a.width/2+","+o+")"),i}var oe=function(e,t){var r=t.nodes().filter(function(a){return Ke(t,a)}),n=e.selectAll("g.cluster").data(r,function(a){return a});_(n.exit(),t).style("opacity",0).remove();var i=n.enter().append("g").attr("class","cluster").attr("id",function(a){var o=t.node(a);return o.id}).style("opacity",0).each(function(a){var o=t.node(a),s=x(this);x(this).append("rect");var d=s.append("g").attr("class","label");ge(d,o,o.clusterLabelPos)});return n=n.merge(i),n=_(n,t).style("opacity",1),n.selectAll("rect").each(function(a){var o=t.node(a),s=x(this);N(s,o.style)}),n};function vn(e){oe=e}let se=function(e,t){var r=e.selectAll("g.edgeLabel").data(t.edges(),function(i){return Qe(i)}).classed("update",!0);r.exit().remove(),r.enter().append("g").classed("edgeLabel",!0).style("opacity",0),r=e.selectAll("g.edgeLabel"),r.each(function(i){var a=x(this);a.select(".label").remove();var o=t.edge(i),s=ge(a,t.edge(i),0).classed("label",!0),d=s.node().getBBox();o.labelId&&s.attr("id",o.labelId),p(o,"width")||(o.width=d.width),p(o,"height")||(o.height=d.height)});var n;return r.exit?n=r.exit():n=r.selectAll(null),_(n,t).style("opacity",0).remove(),r};function pn(e){se=e}function Be(e,t){return e.intersect(t)}var de=function(e,t,r){var n=e.selectAll("g.edgePath").data(t.edges(),function(o){return Qe(o)}).classed("update",!0),i=yn(n,t);xn(n,t);var a=n.merge!==void 0?n.merge(i):n;return _(a,t).style("opacity",1),a.each(function(o){var s=x(this),d=t.edge(o);d.elem=this,d.id&&s.attr("id",d.id),Ze(s,d.class,(s.classed("update")?"update ":"")+"edgePath")}),a.selectAll("path.path").each(function(o){var s=t.edge(o);s.arrowheadId=X("arrowhead");var d=x(this).attr("marker-end",function(){return"url("+mn(location.href,s.arrowheadId)+")"}).style("fill","none");_(d,t).attr("d",function(u){return wn(t,u)}),N(d,s.style)}),a.selectAll("defs *").remove(),a.selectAll("defs").each(function(o){var s=t.edge(o),d=r[s.arrowhead];d(x(this),s.arrowheadId,s,"arrowhead")}),a};function gn(e){de=e}function mn(e,t){var r=e.split("#")[0];return r+"#"+t}function wn(e,t){var r=e.edge(t),n=e.node(t.v),i=e.node(t.w),a=r.points.slice(1,r.points.length-1);return a.unshift(Be(n,a[0])),a.push(Be(i,a[a.length-1])),et(r,a)}function et(e,t){var r=(ft||ct.line)().x(function(n){return n.x}).y(function(n){return n.y});return(r.curve||r.interpolate)(e.curve),r(t)}function bn(e){var t=e.getBBox(),r=e.ownerSVGElement.getScreenCTM().inverse().multiply(e.getScreenCTM()).translate(t.width/2,t.height/2);return{x:r.e,y:r.f}}function yn(e,t){var r=e.enter().append("g").attr("class","edgePath").style("opacity",0);return r.append("path").attr("class","path").attr("d",function(n){var i=t.edge(n),a=t.node(n.v).elem,o=T(i.points.length).map(function(){return bn(a)});return et(i,o)}),r.append("defs"),r}function xn(e,t){var r=e.exit();_(r,t).style("opacity",0).remove()}var ue=function(e,t,r){var n=t.nodes().filter(function(o){return!Ke(t,o)}),i=e.selectAll("g.node").data(n,function(o){return o}).classed("update",!0);i.exit().remove(),i.enter().append("g").attr("class","node").style("opacity",0),i=e.selectAll("g.node"),i.each(function(o){var s=t.node(o),d=x(this);Ze(d,s.class,(d.classed("update")?"update ":"")+"node"),d.select("g.label").remove();var u=d.append("g").attr("class","label"),h=ge(u,s),c=r[s.shape],l=V(h.node().getBBox(),"width","height");s.elem=this,s.id&&d.attr("id",s.id),s.labelId&&u.attr("id",s.labelId),p(s,"width")&&(l.width=s.width),p(s,"height")&&(l.height=s.height),l.width+=s.paddingLeft+s.paddingRight,l.height+=s.paddingTop+s.paddingBottom,u.attr("transform","translate("+(s.paddingLeft-s.paddingRight)/2+","+(s.paddingTop-s.paddingBottom)/2+")");var g=x(this);g.select(".label-container").remove();var v=c(g,l,s).classed("label-container",!0);N(v,s.style);var m=v.node().getBBox();s.width=m.width,s.height=m.height});var a;return i.exit?a=i.exit():a=i.selectAll(null),_(a,t).style("opacity",0).remove(),i};function _n(e){ue=e}function En(e,t){var r=e.filter(function(){return!x(this).classed("update")});function n(i){var a=t.node(i);return"translate("+a.x+","+a.y+")"}r.attr("transform",n),_(e,t).style("opacity",1).attr("transform",n),_(r.selectAll("rect"),t).attr("width",function(i){return t.node(i).width}).attr("height",function(i){return t.node(i).height}).attr("x",function(i){var a=t.node(i);return-a.width/2}).attr("y",function(i){var a=t.node(i);return-a.height/2})}function kn(e,t){var r=e.filter(function(){return!x(this).classed("update")});function n(i){var a=t.edge(i);return p(a,"x")?"translate("+a.x+","+a.y+")":""}r.attr("transform",n),_(e,t).style("opacity",1).attr("transform",n)}function Ln(e,t){var r=e.filter(function(){return!x(this).classed("update")});function n(i){var a=t.node(i);return"translate("+a.x+","+a.y+")"}r.attr("transform",n),_(e,t).style("opacity",1).attr("transform",n)}function tt(e,t,r,n){var i=e.x,a=e.y,o=i-n.x,s=a-n.y,d=Math.sqrt(t*t*s*s+r*r*o*o),u=Math.abs(t*r*o/d);n.x<i&&(u=-u);var h=Math.abs(t*r*s/d);return n.y<a&&(h=-h),{x:i+u,y:a+h}}function Nn(e,t,r){return tt(e,t,t,r)}function Cn(e,t,r,n){var i,a,o,s,d,u,h,c,l,g,v,m,y,C,B;if(i=t.y-e.y,o=e.x-t.x,d=t.x*e.y-e.x*t.y,l=i*r.x+o*r.y+d,g=i*n.x+o*n.y+d,!(l!==0&&g!==0&&Ae(l,g))&&(a=n.y-r.y,s=r.x-n.x,u=n.x*r.y-r.x*n.y,h=a*e.x+s*e.y+u,c=a*t.x+s*t.y+u,!(h!==0&&c!==0&&Ae(h,c))&&(v=i*s-a*o,v!==0)))return m=Math.abs(v/2),y=o*u-s*d,C=y<0?(y-m)/v:(y+m)/v,y=a*d-i*u,B=y<0?(y-m)/v:(y+m)/v,{x:C,y:B}}function Ae(e,t){return e*t>0}function In(e,t,r){var n=e.x,i=e.y,a=[],o=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY;t.forEach(function(v){o=Math.min(o,v.x),s=Math.min(s,v.y)});for(var d=n-e.width/2-o,u=i-e.height/2-s,h=0;h<t.length;h++){var c=t[h],l=t[h<t.length-1?h+1:0],g=Cn(e,r,{x:d+c.x,y:u+c.y},{x:d+l.x,y:u+l.y});g&&a.push(g)}return a.length?(a.length>1&&a.sort(function(v,m){var y=v.x-r.x,C=v.y-r.y,B=Math.sqrt(y*y+C*C),me=m.x-r.x,we=m.y-r.y,be=Math.sqrt(me*me+we*we);return B<be?-1:B===be?0:1}),a[0]):(console.log("NO INTERSECTION FOUND, RETURN NODE CENTER",e),e)}function Tn(e,t){var r=e.x,n=e.y,i=t.x-r,a=t.y-n,o=e.width/2,s=e.height/2,d,u;return Math.abs(a)*o>Math.abs(i)*s?(a<0&&(s=-s),d=a===0?0:s*i/a,u=s):(i<0&&(o=-o),d=o,u=i===0?0:o*a/i),{x:r+d,y:n+u}}var fe={rect:Rn,ellipse:Mn,circle:Pn,diamond:On};function Sn(e){fe=e}function Rn(e,t,r){var n=e.insert("rect",":first-child").attr("rx",r.rx).attr("ry",r.ry).attr("x",-t.width/2).attr("y",-t.height/2).attr("width",t.width).attr("height",t.height);return r.intersect=function(i){return Tn(r,i)},n}function Mn(e,t,r){var n=t.width/2,i=t.height/2,a=e.insert("ellipse",":first-child").attr("x",-t.width/2).attr("y",-t.height/2).attr("rx",n).attr("ry",i);return r.intersect=function(o){return tt(r,n,i,o)},a}function Pn(e,t,r){var n=Math.max(t.width,t.height)/2,i=e.insert("circle",":first-child").attr("x",-t.width/2).attr("y",-t.height/2).attr("r",n);return r.intersect=function(a){return Nn(r,n,a)},i}function On(e,t,r){var n=t.width*Math.SQRT2/2,i=t.height*Math.SQRT2/2,a=[{x:0,y:-i},{x:-n,y:0},{x:0,y:i},{x:n,y:0}],o=e.insert("polygon",":first-child").attr("points",a.map(function(s){return s.x+","+s.y}).join(" "));return r.intersect=function(s){return In(r,a,s)},o}function $n(){var e=function(t,r){Dn(r);var n=A(t,"output"),i=A(n,"clusters"),a=A(n,"edgePaths"),o=se(A(n,"edgeLabels"),r),s=ue(A(n,"nodes"),r,fe);Or(r),Ln(s,r),kn(o,r),de(a,r,ae);var d=oe(i,r);En(d,r),Fn(r)};return e.createNodes=function(t){return arguments.length?(_n(t),e):ue},e.createClusters=function(t){return arguments.length?(vn(t),e):oe},e.createEdgeLabels=function(t){return arguments.length?(pn(t),e):se},e.createEdgePaths=function(t){return arguments.length?(gn(t),e):de},e.shapes=function(t){return arguments.length?(Sn(t),e):fe},e.arrows=function(t){return arguments.length?(on(t),e):ae},e}var Bn={paddingLeft:10,paddingRight:10,paddingTop:10,paddingBottom:10,rx:0,ry:0,shape:"rect"},An={arrowhead:"normal",curve:ht};function Dn(e){e.nodes().forEach(function(t){var r=e.node(t);!p(r,"label")&&!e.children(t).length&&(r.label=t),p(r,"paddingX")&&P(r,{paddingLeft:r.paddingX,paddingRight:r.paddingX}),p(r,"paddingY")&&P(r,{paddingTop:r.paddingY,paddingBottom:r.paddingY}),p(r,"padding")&&P(r,{paddingLeft:r.padding,paddingRight:r.padding,paddingTop:r.padding,paddingBottom:r.padding}),P(r,Bn),f(["paddingLeft","paddingRight","paddingTop","paddingBottom"],function(n){r[n]=Number(r[n])}),p(r,"width")&&(r._prevWidth=r.width),p(r,"height")&&(r._prevHeight=r.height)}),e.edges().forEach(function(t){var r=e.edge(t);p(r,"label")||(r.label=""),P(r,An)})}function Fn(e){f(e.nodes(),function(t){var r=e.node(t);p(r,"_prevWidth")?r.width=r._prevWidth:delete r.width,p(r,"_prevHeight")?r.height=r._prevHeight:delete r.height,delete r._prevWidth,delete r._prevHeight})}function A(e,t){var r=e.select("g."+t);return r.empty()&&(r=e.append("g").attr("class",t)),r}function zn(e){var t={options:{directed:e.isDirected(),multigraph:e.isMultigraph(),compound:e.isCompound()},nodes:Gn(e),edges:Vn(e)};return w(e.graph())||(t.value=ut(e.graph())),t}function Gn(e){return b(e.nodes(),function(t){var r=e.node(t),n=e.parent(t),i={v:t};return w(r)||(i.value=r),w(n)||(i.parent=n),i})}function Vn(e){return b(e.edges(),function(t){var r=e.edge(t),n={v:t.v,w:t.w};return w(t.name)||(n.name=t.name),w(r)||(n.value=r),n})}export{E as G,fn as a,N as b,Tn as c,In as i,Or as l,$n as r,zn as w};
